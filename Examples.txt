allocslot lpwstr buffer: 17 chars; call secur32.dll!GetUserNameExW /return byte (int 2, slotdata buffer, blockptr(allocsize buffer in chars as ulong)); readslot buffer
newslot int size = 0; call kernel32.dll!GetComputerNameW (nullptr, slotptr size); allocslot lpwstr name: size chars; call kernel32.dll!GetComputerNameW /return int (slotdata name, slotptr size); readslot name
call user32.dll!SetSysColors /return int (int 1, blockptr(int 8), blockptr(int 0xAA4400))
call kernel32.dll!OpenProcess /return native /into prochandle (int 0x400, int 0, slotdata parentpid); newslot native token; call advapi32.dll!OpenProcessToken /return int (slotdata prochandle, int 0x20, slotptr token); newslot block luid = int 0, int 0; call advapi32.dll!LookupPrivilegeValueW /return int (nullptr, lpwstr "SeRestorePrivilege", slotptr luid); newslot block privs = int 1, slotdata luid, int 2; call advapi32.dll!AdjustTokenPrivileges /return int (slotdata token, int 0, slotptr privs, slotsize privs as int, nullptr, nullptr)
newslot native psl; call ole32.dll!CoCreateInstance /return native (blockptr(guid {00021401-0000-0000-C000-000000000046}), nullptr, int 1, blockptr(guid {000214F9-0000-0000-C000-000000000046}), slotptr psl); newslot native ppf;